#!/usr/bin/env ruby
require 'bundler/setup'
require 'pry'

def reload!
  Object.send(:remove_const, :Redstruct) if Object.const_defined?(:Redstruct)
  $LOADED_FEATURES.reject! { |path| path =~ %r{/lib/redstruct} }

  require 'redstruct'

  # Prepare connection configuration
  Redstruct.config.namespace = 'redstruct'.freeze
  Redstruct.config.connection_pool = ConnectionPool.new(size: 2, timeout: 5) { Redis.new }
  return nil
end

reload!
Pry.start
